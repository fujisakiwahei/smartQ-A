# 機能詳細：AI 応答エンジン (AI Chat Pipeline)

## 1. 処理構成

最新の **Gemini 3.0 Flash** を活用し、「速さ」と「正確性」を両立した 2 段階処理を行う。

### ステップ 1：カテゴリ特定 (Classification)

- **AI 設定**: `thinking_level: minimal` を使用し、極限までレスポンスを速める。
- **入力**: ユーザー質問 ＋ カテゴリリスト ＋ 各カテゴリの Description (最大 350 文字)。
- **出力**: 該当するカテゴリ ID。

### ステップ 2：根拠に基づく回答生成 (Grounded Generation)

- **AI 設定**: `thinking_level: low` を使用し、論理的整合性を確保する。
- **コンテキスト**: 特定されたカテゴリに属する Q&A リストのみを Firestore から注入。
- **ガードレール**: プロンプトにて「提供された知識データ以外は答えない（ハルシネーション抑制）」を徹底。

## 2. コスト・パフォーマンス

- **入力トークン単価**: $0.50 / 1M tokens。
- **出力スピード**: 秒間約 200 トークン以上の爆速生成。
- **目標応答時間**: 全工程で 2.0 〜 3.0 秒以内。

## 3. プロンプト注入ロジック

- カテゴリ Description (350 文字) を AI が「そのカテゴリに含まれる具体的なキーワード」として認識できるよう整形して渡す。
